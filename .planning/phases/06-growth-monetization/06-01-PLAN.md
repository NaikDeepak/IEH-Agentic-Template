# Plan: 06-01 - Referral Code Generation & Persistence

## Goal
Assign a unique, static alphanumeric referral code to every user and provide a reverse lookup for registration.

## Proposed Changes

### 1. Utility: Code Generator
- Create `src/lib/utils/codes.ts` with a function `generateReferralCode()`.
- Format: `IEH-[6 chars]`.

### 2. Service: Referral Persistence
- Create `src/features/growth/services/referralService.ts`.
- `ensureReferralCode(uid)`: 
  - Check if `users/{uid}` has `referralCode`.
  - If not, generate one, verify uniqueness in `referralCodes/` collection.
  - Save to `users/{uid}` and `referralCodes/{code}`.

### 3. Integration: Profile & Registration
- Hook `ensureReferralCode` into the login/registration flow (e.g., in `useAuth` or a layout wrapper).
- Update the registration form to optionally accept a referral code and store it as `referredBy` (uid) in the new user's profile.

## Verification Plan
1. Log in with a new account.
2. Verify a code is generated in Firestore.
3. Try to register another account using that code.
4. Verify the `referredBy` field is correctly set.
