---
phase: 04-employer-suite
plan: 09
type: execute
wave: 4
depends_on: [04-08]
files_modified: [src/pages/PostJob.tsx, src/server/features/ai/ai.controller.js, src/server/features/ai/ai.service.js]
autonomous: true
gap_closure: true
must_haves:
  truths:
    - "Job posting UI shows location, type, and mode before the AI generation button"
    - "AI generated description incorporates location and employment type context"
  artifacts:
    - path: "src/pages/PostJob.tsx"
      provides: "Context-aware job posting flow"
    - path: "src/server/features/ai/ai.service.js"
      provides: "Enhanced Gemini prompt logic"
---

<objective>
Rearrange the Job Posting UI flow to capture key details (Position, Skills, Location, Type, Mode) before generating the Job Description. Update the AI service to utilize these fields for more context-aware generation.
</objective>

<execution_context>
@/Users/deepaknaik/.claude/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/ROADMAP.md
@src/pages/PostJob.tsx
@src/server/features/ai/ai.controller.js
@src/server/features/ai/ai.service.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Reorder Job Posting UI and Collect Context</name>
  <files>src/pages/PostJob.tsx</files>
  <action>
    - Rearrange the layout in `PostJob.tsx`:
      1. Section 1: Job Title
      2. Section 2: Role Context (Skills, Location, Type, Mode)
      3. Action: "Generate Description with AI" button
      4. Section 3: Job Description Editor
      5. Section 4: Screening, Salary, and Contact
    - Update `handleAiGenerateJd` to include `location`, `type`, and `work_mode` from the form state in the request payload to `/api/ai/generate-jd`.
  </action>
  <verify>Manual verification: Verify UI layout order and check network request payload for new context fields.</verify>
  <done>UI flows from context to generation, and frontend sends full context to backend.</done>
</task>

<task type="auto">
  <name>Task 2: Update AI Backend to Support Context Fields</name>
  <files>src/server/features/ai/ai.controller.js, src/server/features/ai/ai.service.js</files>
  <action>
    - In `ai.controller.js`: Extract `location`, `type`, and `work_mode` from `req.body` and pass them to the service.
    - In `ai.service.js`: Update the `generateJD` prompt to incorporate the provided location, job type, and work mode into the generated description instructions for Gemini.
  </action>
  <verify>Generate a JD and confirm it mentions the specific location or work mode provided in the form.</verify>
  <done>Backend utilizes all provided role context to generate more accurate descriptions.</done>
</task>

</tasks>

<verification>
1. Navigate to /post-job.
2. Fill Title, Location (e.g., "New York"), and Mode (e.g., "Remote").
3. Click "Generate Description".
4. Verify the generated text acknowledges the location and remote status.
</verification>

<success_criteria>
- [ ] UI layout reordered as requested by user.
- [ ] AI generation utilizes Location, Type, and Work Mode fields.
</success_criteria>

<output>
After completion, create `.planning/phases/04-employer-suite/04-09-SUMMARY.md`
</output>
