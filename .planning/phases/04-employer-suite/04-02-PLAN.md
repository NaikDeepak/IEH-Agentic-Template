---
phase: 04-employer-suite
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified: [functions/index.js, src/features/jobs/types.ts, src/features/jobs/services/jobService.ts, src/pages/PostJob.tsx]
autonomous: true
must_haves:
  truths:
    - "Employer can click 'AI Generate' to populate job description"
    - "AI generates role-specific screening questions automatically"
    - "Job postings are linked to the employer's company profile"
  artifacts:
    - path: "functions/index.js"
      provides: "AI screening question endpoint"
    - path: "src/pages/PostJob.tsx"
      provides: "AI-assisted job creation UI"
  key_links:
    - from: "src/pages/PostJob.tsx"
      to: "/api/ai/generate-questions"
      via: "POST request"
    - from: "src/features/jobs/services/jobService.ts"
      to: "companies collection"
      via: "company_id field"
---

<objective>
Enhance the job posting experience by integrating AI generation for both descriptions and screening questions, and ensuring all jobs are correctly linked to company branding.

Purpose: High-quality job postings with less manual effort.
Output: AI-enhanced Job Posting UI and backend capabilities.
</objective>

<execution_context>
@/Users/deepaknaik/.claude/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-employer-suite/04-RESEARCH.md
@.planning/phases/04-employer-suite/04-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: AI Screening & Optimization Backend</name>
  <files>functions/index.js</files>
  <action>
    Add a new Cloud Function handler `generateQuestionsHandler`.
    Prompt Gemini 2.0 Flash to:
    1. Generate 3-5 screening questions based on the JD: `[{ "question": string, "hint": string }]`.
    2. Provide 3-5 optimization suggestions for the JD (e.g., "Add more details about tech stack", "Clarify remote policy"): `[string]`.
    Return JSON: `{ "questions": [...], "suggestions": [...] }`.
    Register route `/ai/generate-job-assist` (authenticated).
  </action>
  <verify>Test endpoint with curl/Postman; verify both questions and suggestions are returned.</verify>
  <done>Backend can generate structured screening questions and optimization suggestions.</done>
</task>

<task type="auto">
  <name>Task 2: Update Job Schema & Service</name>
  <files>src/features/jobs/types.ts, src/features/jobs/services/jobService.ts</files>
  <action>
    Add `company_id` and `screening_questions` (array of objects) to `JobPosting` and `CreateJobInput`.
    Update `JobService.createJob` to accept these new fields.
    Ensure `createJob` fetches the current user's `company_id` if not provided.
  </action>
  <verify>Typescript types are updated; `JobService` compiles.</verify>
  <done>Data layer supports AI-enhanced job metadata.</done>
</task>

<task type="auto">
  <name>Task 3: AI-Enhanced PostJob UI</name>
  <files>src/pages/PostJob.tsx, src/features/jobs/types.ts, src/features/jobs/services/jobService.ts</files>
  <action>
    Integrate "AI Generate" buttons for the Description and Screening Questions.
    When generating JD: call `/ai/generate-jd`, update description field.
    When generating Questions/Suggestions: call `/ai/generate-job-assist`, display questions in an editable list and show suggestions as a checklist or alert.
    Style using the IEH Brutalist design language.
  </action>
  <verify>Clicking 'AI Generate' populates fields and shows suggestions; job saves with questions and company_id.</verify>
  <done>Employer has an AI-assisted workflow with optimization tips for high-quality job postings.</done>
</task>

</tasks>

<verification>
1. Login as Employer with a set up Company.
2. Go to Post Job.
3. Enter title/skills.
4. Click 'AI Generate' for Description.
5. Click 'AI Generate' for Screening Questions.
6. Verify questions are editable.
7. Save and verify Firestore document contains `company_id` and `screening_questions`.
</verification>

<success_criteria>
Job postings are now higher quality, more structured, and professional.
</success_criteria>

<output>
After completion, create `.planning/phases/04-employer-suite/04-02-SUMMARY.md`
</output>
